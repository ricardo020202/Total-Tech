<%- include('includes/headAdmin.ejs') %>
<%- include('includes/sidebar.ejs') %> 
<link rel="stylesheet" href="/css/adminStyle.css">

<!-- <div class="row ">
  <div class="col">
    <div class="form-group">
      <input type="text" class="form-control" id="searchInput" placeholder="Buscar dieta...">
    </div>
  </div>
  <div class="col">
    <a href="/admin/admindashboard/diets/add" class="btn btn-success"><i class="material-icons">&#xE147;</i> <span>Agregar nueva dieta</span></a>
  </div>
</div> -->
<div class="table-responsive">
  <div class="table-title">
    <div class="row">
      <div class="col-sm-6">
        <h2><b>Dieta</b></h2>
      </div>
      <div class="col-sm-6">
        <a href="/admin/admindashboard/diets/add" class="btn btn-success"><i class="material-icons"></i> <span>Agregar nueva dieta</span></a>
      </div>
    </div>
  </div>
  <table class="table-active table-striped">
    <thead class="table-header">
      <tr>
        <th scope="col">Id dieta</th>
        <th scope="col">Nombre dieta</th>
        <th scope="col">Grasas</th>
        <th scope="col">Proteínas</th>
        <th scope="col">Calorías</th>
        <th scope="col">Carbohidratos</th>
        <th scope="col">Grasas</th>
        <th scope="col">Fibra</th>
        <th scope="col">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <% for(let i = 0; i < dieta.length; i++) { %>
        <tr>
          <td>
            <%= dieta[i].id_dieta %>
          </td>
          <td>
            <%= dieta[i].nombre_dieta %>
          </td>
          <td>
            <%= dieta[i].grasas %>
          </td>
          <td>
            <%= dieta[i].proteinas %>
          </td>
          <td>
            <%= dieta[i].calorias %>
          </td>
          <td>
            <%= dieta[i].carbohidratos %>
          </td>
          <td>
            <%= dieta[i].grasas %>
          </td>
          <td>
            <%= dieta[i].fibra_total %>
          </td>
          <td>
            <i class="fa-solid fa-pen-to-square fa-lg" style="color: #000;"></i>
            <i class="fa-sharp fa-solid fa-trash fa-lg" style="color: #000;"></i>
            <form
              id="delete-form"
              method="post"
              action="/admin/admindashboard/diets/delete/<%= dieta[i].id_dieta %>"
            >
                <input
                    type="hidden"
                    name="_csrf"
                    value="<%= csrfToken %>"
                />
                <button type="submit" class="btn btn-outline-dark">Eliminar</button>
            </form>

            <div id="confirm-delete" class="confirm-dialog">
                <div class="confirm-dialog-content">
                    <h2>Confirmar Eliminar</h2>
                    <p>¿Estás seguro que quieres eliminar esta dieta?</p>
                    <div class="confirm-dialog-buttons">
                        <button id="confirm-delete-yes" class="btn btn-danger">Eliminar</button>
                        <button id="confirm-delete-no" class="btn btn-secondary">Cancelar</button>
                    </div>
                </div>
            </div>

          </td>
        </tr>
        <% } %>
    </tbody>
  </table>
</div>
<div class="table-responsive">
  <div class="table-title">
    <div class="row">
      <div class="col-sm-6">
        <h2><b>Alimentos</b></h2>
      </div>
      <div class="col-sm-6">
        <a href="/admin/admindashboard/diets/Alimento/add" class="btn btn-success"><i class="material-icons"></i> <span>Agregar nuevo alimento</span></a>
      </div>
    </div>
  </div>
  <table class="table-active table-striped">
    <thead class="table-header">
      <tr>
        <th scope="col">Id alimento</th>
        <th scope="col">Descripción alimento</th>
        <th scope="col">Unidad</th>
        <th scope="col">Cantidad</th>
        <th scope="col">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <% for(let i = 0; i < alimento.length; i++) { %>
        <tr>
          <td>
            <%= alimento[i].id_alimento %>
          </td>
          <td>
            <%= alimento[i].descripcion_alimento %>
          </td>
          <td>
            <%= alimento[i].unidad %>
          </td>
          <td>
            <%= alimento[i].cantidad %>
          </td>
          <td>
            <a href="/admin/admindashboard/diets/modAlimento/<%= alimento[i].id_alimento %>">
              <i class="fa-solid fa-pen-to-square fa-lg" style="color: #000;"></i>
            </a>
            <a href="/admin/admindashboard/diets/deleteFood/<%= alimento[i].id_alimento %>" onclick="return confirm('¿Estás seguro de que quieres eliminar este alimento? Se eliminarán los registros de dieta asociados')">
              <i class="fa-sharp fa-solid fa-trash fa-lg" style="color: #000;"></i>
            </a>
          </td>
        </tr>
        <% } %>
    </tbody>
  </table>
</div>

<script>
  const deleteForm = document.getElementById('delete-form');
  const confirmDelete = document.getElementById('confirm-delete');
  const confirmDeleteYes = document.getElementById('confirm-delete-yes');
  const confirmDeleteNo = document.getElementById('confirm-delete-no');

  deleteForm.addEventListener('submit', (event) => {
      event.preventDefault();
      confirmDelete.style.display = 'block';
  });

  confirmDeleteYes.addEventListener('click', () => {
      deleteForm.submit();
  });

  confirmDeleteNo.addEventListener('click', () => {
      confirmDelete.style.display = 'none';
  });
</script>

<%- include('includes/footAdmin.ejs') %>

